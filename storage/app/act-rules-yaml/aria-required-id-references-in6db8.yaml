machine_name: aria-required-id-references-in6db8
id: in6db8
name: 'ARIA required ID references exist'
metadata:
    id: in6db8
    name: 'ARIA required ID references exist'
    rule_type: atomic
    description: "This rule checks that every ID reference required by WAI-ARIA exists\n"
    accessibility_requirements: { 'aria12:propcharacteristic_value': { title: 'ARIA 1.2, 6.2.4 Value (Characteristics of States and Properties)', forConformance: true, failed: 'not satisfied', passed: satisfied, inapplicable: satisfied }, 'wcag20:1.3.1': { secondary: 'This success criterion is **less strict** than this rule. This is because the rule does not check for alternatives which may be accessible. Some of the failed examples satisfy this success criterion.' }, 'wcag20:4.1.2': { secondary: 'This success criterion is **less strict** than this rule. This is because the rule does not check for alternatives which may be accessible. Some of the failed examples satisfy this success criterion.' } }
    input_aspects: ['DOM Tree', 'CSS Styling']
    acknowledgments: { authors: ['Wilco Fiers'] }
applicability: "This rule applies to any `aria-controls` attribute defined on an HTML element for which one of the following is true:\n\n- <dfn>expanded combobox</dfn>: the element is a semantic `combobox` with an `aria-expanded` attribute value of `true`; or\n- <dfn>scrollbar</dfn>: the element is a semantic `scrollbar`."
assumptions: 'There are no assumptions.'
accessibility_support: 'Some user agents treat the value of `aria-*` attribute as case-sensitive (even when these are not IDs) while some treat them as case-insensitive.'
background: "This rule is written specifically for `aria-controls`, because it is the only ID Reference List property that is required by WAI-ARIA. The `aria-controls` property is only required by the `scrollbar` role and by an expanded `combobox`. There are no ID Reference properties that are required by WAI-ARIA for any role.\n\n### Bibliography\n\n- [ARIA5: Using WAI-ARIA state and property attributes to expose the state of a user interface component](https://www.w3.org/WAI/WCAG22/Techniques/aria/ARIA5)\n- [WAI-ARIA required states and properties](https://www.w3.org/TR/wai-aria-1.2/#requiredState)\n- [RFC 3986](https://www.ietf.org/rfc/rfc3986.txt)"
test_cases:
    passed: [{ name: 'Passed Example 1', description: 'The `aria-controls` attribute value of this `scrollbar` matches the `id` of the `main` element in the same document.', html: "<main id=\"content\">Lorem ipsum...</main>\n<div\n\trole=\"scrollbar\"\n\taria-controls=\"content\"\n\taria-orientation=\"vertical\"\n\taria-valuemax=\"100\"\n\taria-valuemin=\"0\"\n\taria-valuenow=\"25\"\n></div>" }, { name: 'Passed Example 2', description: 'The `aria-controls` attribute value of this expanded `combobox` matches the `id` of the `ul` element in the same document.', html: "<label for=\"tag_combo\">Tag</label>\n<input\n\ttype=\"text\"\n\tid=\"tag_combo\"\n\trole=\"combobox\"\n\taria-expanded=\"true\"\n\taria-controls=\"popup_listbox\"\n\taria-activedescendant=\"selected_option\"\n/>\n<ul role=\"listbox\" id=\"popup_listbox\">\n\t<li role=\"option\">Zebra</li>\n\t<li role=\"option\" id=\"selected_option\">Zoom</li>\n</ul>" }, { name: 'Passed Example 3', description: 'The `aria-controls` attribute value of this `scrollbar` has two IDs. The `content-2` ID matches the `id` of the `main` element in the same document.', html: "<main id=\"content-2\">Lorem ipsum...</main>\n<div\n\trole=\"scrollbar\"\n\taria-controls=\"content-1 content-2\"\n\taria-orientation=\"vertical\"\n\taria-valuemax=\"100\"\n\taria-valuemin=\"0\"\n\taria-valuenow=\"25\"\n></div>" }]
    failed: [{ name: 'Failed Example 1', description: 'The `aria-controls` attribute of this expanded `combobox` references an ID of `popup_listbox` which does not exist in the document.', html: "<label>\n\tTag\n\t<input role=\"combobox\" aria-expanded=\"true\" aria-controls=\"popup_listbox\" />\n</label>" }, { name: 'Failed Example 2', description: 'The `aria-controls` attribute of this `scrollbar` references IDs of `content-1` and `content-2`. Neither of these IDs exist in the document.', html: "<main>Lorem ipsum...</main>\n<div\n\trole=\"scrollbar\"\n\taria-controls=\"content-1 content-2\"\n\taria-orientation=\"vertical\"\n\taria-valuemax=\"100\"\n\taria-valuemin=\"0\"\n\taria-valuenow=\"25\"\n></div>" }, { name: 'Failed Example 3', description: 'The `aria-controls` attribute of this expanded `combobox` references a `popup_listbox` ID. This `id` exists, but in a different DOM tree as the `combobox`.', html: "<div id=\"aria-listbox\">\n\t<label for=\"tag_combo\">Tag</label>\n\t<input\n\t\ttype=\"text\"\n\t\tid=\"tag_combo\"\n\t\trole=\"combobox\"\n\t\taria-expanded=\"true\"\n\t\taria-controls=\"popup_listbox\"\n\t\taria-activedescendant=\"selected_option\"\n\t/>\n</div>\n<script>\n\tconst ariaListbox = document.querySelector('#aria-listbox')\n\tconst shadowRoot = ariaListbox.attachShadow({ mode: 'open' })\n\tshadowRoot.innerHTML = `\n\t\t<slot></slot>\n\t\t<ul role=\"listbox\" id=\"popup_listbox\">\n\t\t\t<li role=\"option\">Zebra</li>\n\t\t\t<li role=\"option\" id=\"selected_option\">Zoom</li>\n\t\t</ul>\n\t`\n</script>" }]
    inapplicable: [{ name: 'Inapplicable Example 1', description: 'The `aria-controls` attribute is defined on a `combobox` which does not have an `aria-expanded` attribute value of `true`.', html: "<label for=\"tag_combo\">Tag</label>\n<input type=\"text\" id=\"tag_combo\" role=\"combobox\" aria-expanded=\"false\" aria-controls=\"popup_listbox\" />" }, { name: 'Inapplicable Example 2', description: 'This `aria-controls` attribute is not defined on a semantic `scrollbar` nor `combobox`.', html: '<button aria-controls="my-modal">Open the modal</button>' }, { name: 'Inapplicable Example 3', description: 'There is no `aria-controls` attribute.', html: '<button>Open the modal</button>' }]
expectation: "Each test target's attribute value is a space-separated list of one or more IDs. At least one of those IDs must match an `id` attribute value in the same shadow tree or, if not within a shadow tree, within the same document."
