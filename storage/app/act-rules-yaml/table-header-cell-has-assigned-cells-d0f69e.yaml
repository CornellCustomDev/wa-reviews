id: d0f69e
name: 'Table header cell has assigned cells'
metadata:
    id: d0f69e
    name: 'Table header cell has assigned cells'
    rule_type: atomic
    description: "This rule checks that each table header has assigned cells in a table element.\n"
    accessibility_requirements: { 'wcag20:1.3.1': { forConformance: true, failed: 'not satisfied', passed: 'further testing needed', inapplicable: 'further testing needed' } }
    input_aspects: ['Accessibility Tree', 'CSS styling', 'DOM Tree']
    acknowledgments: { authors: ['Audrey Maniez', 'Helen Burge', 'Jey Nandakumar'], funding: [WAI-Tools] }
applicability: "This rule applies to any HTML element with a semantic rowheader or columnheader for which all of the following is true:\n\n- the element is visible; and\n- the element is included in the accessibility tree; and\n- the element has at least one ancestor in the flat tree that is a semantic table or grid; and\n- the element's closest ancestor in the flat tree that is a semantic table or grid is included in the accessibility tree."
assumptions: 'This rule assumes that table header cells have a relationship conveyed through presentation with other cells within the same table. This excludes edge cases such as a table definition where there is only one header cell, or a table definition where there are multiple headers and no other cells. In such scenarios the rule fails, but success criterion 1.3.1 Info and Relationships could still be satisfied.'
accessibility_support: "- Table markup and header cell association is not well supported by some popular assistive technologies. Passing this rule can still cause issues for users of those assistive technologies.\n- Implementation of Presentational Roles Conflict Resolution varies from one browser or assistive technology to another. Depending on this, some elements can have one of the applicable semantic roles and fail this rule with some technology but users of other technologies would not experience any accessibility issue."
background: "The roles inheriting from `cell` are `columnheader`, `gridcell`, and `rowheader`.\n\n### Bibliography\n\n- Understanding Success Criterion 1.3.1: Information and relationships\n- [H43: Using id and headers attributes to associate data cells with header cells in data tables](https://www.w3.org/WAI/WCAG22/Techniques/html/H43)\n- Forming relationships between data cells and header cells"
test_cases:
    passed: [{ name: 'Passed Example 1', description: 'This `th` element has an assigned `td` element.', html: "<table>\n\t<tr>\n\t\t<th>Time</th>\n\t</tr>\n\t<tr>\n\t\t<td>05:41</td>\n\t</tr>\n</table>" }, { name: 'Passed Example 2', description: 'Each of the 2 `span` elements with role of `columnheader` has assigned `span` elements with a role of `cell`.', html: "<div role=\"table\">\n\t<div role=\"rowgroup\">\n\t\t<div role=\"row\">\n\t\t\t<span role=\"columnheader\">Month</span>\n\t\t\t<span role=\"columnheader\">Top Temperature</span>\n\t\t</div>\n\t</div>\n\t<div role=\"rowgroup\">\n\t\t<div role=\"row\">\n\t\t\t<span role=\"cell\">July</span>\n\t\t\t<span role=\"cell\">40 C</span>\n\t\t</div>\n\t\t<div role=\"row\">\n\t\t\t<span role=\"cell\">August</span>\n\t\t\t<span role=\"cell\">45 C</span>\n\t\t</div>\n\t</div>\n</div>" }, { name: 'Passed Example 3', description: 'Each of the 2 `th` elements has an assigned `td` element because this `td` element spans 2 columns.', html: "<table>\n\t<thead>\n\t\t<tr>\n\t\t\t<th>Projects</th>\n\t\t\t<th>Exams</th>\n\t\t</tr>\n\t</thead>\n\t<tbody>\n\t\t<tr>\n\t\t\t<td colspan=\"2\">15%</td>\n\t\t</tr>\n\t</tbody>\n</table>" }, { name: 'Passed Example 4', description: 'Each of the 4 `th` elements has an assigned `td` element, within the same `table` element having a semantic role of `grid`.', html: "<table role=\"grid\">\n\t<thead>\n\t\t<tr>\n\t\t\t<td></td>\n\t\t\t<th scope=\"col\" role=\"columnheader\">Breakfast</th>\n\t\t\t<th scope=\"col\" role=\"columnheader\">Lunch</th>\n\t\t\t<th scope=\"col\" role=\"columnheader\">Dinner</th>\n\t\t</tr>\n\t</thead>\n\t<tbody>\n\t\t<tr>\n\t\t\t<th scope=\"row\" role=\"rowheader\">Day 1</th>\n\t\t\t<td>8:00</td>\n\t\t\t<td>13:00</td>\n\t\t\t<td>18:00</td>\n\t\t</tr>\n\t</tbody>\n</table>" }, { name: 'Passed Example 5', description: 'Each of the 2 `th` elements has an assigned `td` element because the `headers` attribute assigns the `th` with `id` equal to "col2" to the `td` element.', html: "<table>\n\t<tr>\n\t\t<th id=\"col1\">Cities</th>\n\t\t<th id=\"col2\">Count</th>\n\t</tr>\n\t<tr>\n\t\t<td>Paris</td>\n\t</tr>\n\t<tr>\n\t\t<td headers=\"col2\">1</td>\n\t</tr>\n</table>" }, { name: 'Passed Example 6', description: 'Each of the 5 `th` elements in this table has assigned cells, whether data or header.', html: "<table>\n\t<caption>\n\t\tOpening hours\n\t</caption>\n\t<tr>\n\t\t<th>Day</th>\n\t\t<th>Morning</th>\n\t\t<th>Afternoon</th>\n\t</tr>\n\t<tr>\n\t\t<th>Mon-Fri</th>\n\t\t<td>8-12</td>\n\t\t<td>14-17</td>\n\t</tr>\n\t<tr>\n\t\t<th>Sat-Sun</th>\n\t\t<td>10-14</td>\n\t\t<td>Closed</td>\n\t</tr>\n</table>" }]
    failed: [{ name: 'Failed Example 1', description: 'The `th` element with text "Value" does not have an assigned cell within the same `table` element.', html: "<table>\n\t<thead>\n\t\t<tr>\n\t\t\t<th>Rate</th>\n\t\t\t<th>Value</th>\n\t\t</tr>\n\t</thead>\n\t<tbody>\n\t\t<tr>\n\t\t\t<td>15%</td>\n\t\t</tr>\n\t</tbody>\n</table>" }, { name: 'Failed Example 2', description: 'This `th` element with `id` equal to "col2" does not have an assigned cell within the same `table` element because the `headers` attribute removes the cell association from its column.', html: "<table>\n\t<tr>\n\t\t<th id=\"col1\">Country</th>\n\t\t<th id=\"col2\">Starting with a Z</th>\n\t</tr>\n\t<tr>\n\t\t<td>Zambia</td>\n\t\t<td headers=\"col1\">Zimbabwe</td>\n\t</tr>\n</table>" }, { name: 'Failed Example 3', description: 'This `div` with role of `columnheader` and text equal to "Occupant" does not have an assigned cell within the same `table` element.', html: "<div role=\"grid\">\n\t<div role=\"row\">\n\t\t<div role=\"columnheader\">Room</div>\n\t\t<div role=\"columnheader\">Occupant</div>\n\t</div>\n\t<div role=\"row\">\n\t\t<div role=\"gridcell\">1A</div>\n\t</div>\n\t<div role=\"row\">\n\t\t<div role=\"gridcell\">2A</div>\n\t</div>\n</div>" }]
    inapplicable: [{ name: 'Inapplicable Example 1', description: 'There are no elements with a semantic role of `header` within the `table` element.', html: "<table>\n\t<tr>\n\t\t<td>12:00</td>\n\t</tr>\n</table>" }, { name: 'Inapplicable Example 2', description: 'There are no elements with a semantic role of `header` within the `table` element.', html: '<table></table>' }, { name: 'Inapplicable Example 3', description: 'This `th` element has an explicit role of `cell` and there are no more elements with a semantic role of `header` within the `table` element.', html: "<table>\n\t<tr>\n\t\t<th role=\"cell\">Column A</th>\n\t</tr>\n\t<tr>\n\t\t<td>Cell A</td>\n\t</tr>\n</table>" }, { name: 'Inapplicable Example 4', description: 'This `th` element is neither visible nor included in the accessibility tree and there are no more elements with a semantic role of `header` within the `table` element.', html: "<table>\n\t<tr>\n\t\t<th style=\"display: none;\">Organization</th>\n\t</tr>\n\t<tr>\n\t\t<td>W3C</td>\n\t</tr>\n</table>" }, { name: 'Inapplicable Example 5', description: 'This `th` element is not included in the accessibility tree and there are no more elements with a semantic role of `header` within the `table` element.', html: "<table>\n\t<tr>\n\t\t<th aria-hidden=\"true\">Organization</th>\n\t</tr>\n\t<tr>\n\t\t<td>W3C</td>\n\t</tr>\n</table>" }, { name: 'Inapplicable Example 6', description: 'This `th` element is not a descendant in the flat tree of a semantic `table` or `grid`.', html: "<div>\n\t<tr>\n\t\t<th>Column A</th>\n\t</tr>\n</div>" }, { name: 'Inapplicable Example 7', description: 'This `th` element is part of a table which is not included in the accessibility tree.', html: "<table role=\"presentation\">\n\t<tr>\n\t\t<th>Time</th>\n\t</tr>\n\t<tr>\n\t\t<td>12:00</td>\n\t</tr>\n</table>" }]
expectation: 'Each target element is assigned to at least one element with an inheriting semantic cell.'
